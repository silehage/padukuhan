import{c as J,r as A,ap as L,aq as H,o as M,af as O,h as Y,ac as G,ar as W,as as B,at as X,au as Z,av as ee,aw as te,ax as ae,Y as ne,k as N,e as V,f as y,l as u,w as f,i as t,z as U,D as _,H as S,M as $,v as x,N as j,ay as I,a8 as se,a9 as oe,F as K,R as le,t as k,K as ue,L as re,$ as ie,U as de,az as ce,aA as fe}from"./app-B_plN-HI.js";import{Q as pe}from"./QInput-BXh0MWo7.js";import{Q as R,a as T}from"./QCard-BDjJvimG.js";import{Q as z,a as me}from"./QSelect-BALCaoeM.js";import{C as ve}from"./ClosePopup-BwQ8j78d.js";import"./private.use-form-DpGOz9nW.js";import"./QMenu-Xgvrytqz.js";const be=J({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:E,emit:r}){const b=O(),d=A(null);let m=0;const c=[];function F(a){const o=typeof a=="boolean"?a:l.noErrorFocus!==!0,e=++m,P=(s,i)=>{r(`validation${s===!0?"Success":"Error"}`,i)},h=s=>{const i=s.validate();return typeof i.then=="function"?i.then(p=>({valid:p,comp:s}),p=>({valid:!1,comp:s,err:p})):Promise.resolve({valid:i,comp:s})};return(l.greedy===!0?Promise.all(c.map(h)).then(s=>s.filter(i=>i.valid!==!0)):c.reduce((s,i)=>s.then(()=>h(i).then(p=>{if(p.valid===!1)return Promise.reject(p)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return e===m&&P(!0),!0;if(e===m){const{comp:i,err:p}=s[0];if(p!==void 0&&console.error(p),P(!1,i),o===!0){const Q=s.find(({comp:D})=>typeof D.focus=="function"&&W(D.$)===!1);Q!==void 0&&Q.comp.focus()}}return!1})}function q(){m++,c.forEach(a=>{typeof a.resetValidation=="function"&&a.resetValidation()})}function g(a){a!==void 0&&B(a);const o=m+1;F().then(e=>{o===m&&e===!0&&(l.onSubmit!==void 0?r("submit",a):a?.target!==void 0&&typeof a.target.submit=="function"&&a.target.submit())})}function C(a){a!==void 0&&B(a),r("reset"),X(()=>{q(),l.autofocus===!0&&l.noResetFocus!==!0&&v()})}function v(){Z(()=>{if(d.value===null)return;(d.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||d.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||d.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(d.value.querySelectorAll("[tabindex]"),o=>o.tabIndex!==-1))?.focus({preventScroll:!0})})}ee(te,{bindComponent(a){c.push(a)},unbindComponent(a){const o=c.indexOf(a);o!==-1&&c.splice(o,1)}});let w=!1;return L(()=>{w=!0}),H(()=>{w===!0&&l.autofocus===!0&&v()}),M(()=>{l.autofocus===!0&&v()}),Object.assign(b.proxy,{validate:F,resetValidation:q,submit:g,reset:C,focus:v,getValidationComponents:()=>c}),()=>Y("form",{class:"q-form",ref:d,onSubmit:g,onReset:C},G(E.default))}}),ge={class:"flex justify-end q-gutter-sm"},ye={class:"table-responsive"},xe={class:"table bordered"},ke={key:0,class:"text-left uppercase"},he={class:"q-gutter-xs no-wrap"},Ce={key:0},Pe={class:"card-title flex justify-between items-center"},Ve="Pengurus",Qe={__name:"Index",props:["data","options","penduduk","queryParams"],setup(l){const E=l,r=ae({penduduk_id:"",pengurus_id:""}),b=A(!1),d=A(!1),m=o=>{d.value=!0,b.value=!0,r.penduduk_id=o.id,r.pengurus_id=o.pengurus_id??""},c=()=>{r.reset("penduduk_id","pengurus_id")},F=()=>{c(),d.value=!1,b.value=!0},q=()=>{r.submit(ce(),{onFinish:()=>{b.value=!1,c()}})},g=ne({search:E.queryParams?.search||""}),C=()=>{j.visit(I({query:g}))},v=A([]),w=async(o,e)=>{if(!o||o==""){e(()=>{v.value=[]});return}const h=await(await fetch(fe(o).url)).json();e(()=>{v.value=h.map(n=>({label:n.nama_lengkap,value:n.id}))})},a=o=>de(`${o} ${Ve}`);return(o,e)=>{const P=N("AppHeader"),h=N("AppPagination");return y(),V(K,null,[u(P,{title:"Susunan Pengurus"},{default:f(()=>[t("div",ge,[a("Create")?(y(),U(S,{key:0,color:"primary",onClick:F},{default:f(()=>e[5]||(e[5]=[$("Tambah Data",-1)])),_:1,__:[5]})):_("",!0)])]),_:1}),u(T,{class:"section"},{default:f(()=>[u(R,null,{default:f(()=>[u(pe,{dense:"",outlined:"",placeholder:"Nama",class:"q-mb-md",modelValue:g.search,"onUpdate:modelValue":e[0]||(e[0]=n=>g.search=n),label:"Search",onKeydown:se(oe(C,["prevent"]),["enter"]),clearable:"",onClear:e[1]||(e[1]=n=>x(j).visit(x(I)()))},{append:f(()=>[u(S,{size:"11px",disable:!g.search,color:"dark",icon:"search",flat:"",dense:"",onClick:C},null,8,["disable"])]),_:1},8,["modelValue","onKeydown"]),t("div",null,[t("div",ye,[t("table",xe,[t("thead",null,[t("tr",null,[e[6]||(e[6]=t("th",{class:"text-left uppercase"},"#",-1)),e[7]||(e[7]=t("th",{class:"text-left uppercase"},"Nama",-1)),e[8]||(e[8]=t("th",{class:"text-left uppercase"},"Jabatan",-1)),e[9]||(e[9]=t("th",{class:"text-left uppercase"},"Jenis Kelamin",-1)),e[10]||(e[10]=t("th",{class:"text-left uppercase"},"Tempat Lahir",-1)),e[11]||(e[11]=t("th",{class:"text-left uppercase"},"Tanggal Lahir",-1)),e[12]||(e[12]=t("th",{class:"text-left uppercase"},"Status",-1)),a("Update")?(y(),V("th",ke,"Aksi")):_("",!0)])]),t("tbody",null,[(y(!0),V(K,null,le(l.data.data,(n,s)=>(y(),V("tr",{key:s},[t("td",null,k(l.data.from+s),1),t("td",null,k(n.nama_lengkap),1),t("td",null,k(n.jabatan),1),t("td",null,k(n.Jenis_kelamin),1),t("td",null,k(n.tempat_lahir),1),t("td",null,k(n.tanggal_lahir),1),t("td",null,k(n.status_perkawinan),1),t("td",he,[a("Update")?(y(),U(S,{key:0,class:"btn-action","no-caps":"",color:"blue",onClick:i=>m(n)},{default:f(()=>e[13]||(e[13]=[$("Edit",-1)])),_:2,__:[13]},1032,["onClick"])):_("",!0)])]))),128)),l.data.total?_("",!0):(y(),V("tr",Ce,e[14]||(e[14]=[t("td",{colspan:"20",class:"text-center"},"Tidak ada data",-1)])))])])]),u(h,ue(re(l.data)),null,16)])]),_:1})]),_:1}),u(me,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=n=>b.value=n)},{default:f(()=>[u(T,{class:"section card-lg"},{default:f(()=>[u(R,null,{default:f(()=>[t("div",Pe,[e[15]||(e[15]=t("div",null,"Update Pengurus",-1)),ie(u(S,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),u(be,{onSubmit:q},{default:f(()=>[u(z,{debounce:"700","use-input":"",disable:d.value,"emit-value":"","map-options":"",modelValue:x(r).penduduk_id,"onUpdate:modelValue":e[2]||(e[2]=n=>x(r).penduduk_id=n),label:"Nama Pengurus",options:v.value,onFilter:w},null,8,["disable","modelValue","options"]),u(z,{"emit-value":"","map-options":"",modelValue:x(r).pengurus_id,"onUpdate:modelValue":e[3]||(e[3]=n=>x(r).pengurus_id=n),label:"Jabatan",options:[{label:"Pilih",value:""},...l.options]},null,8,["modelValue","options"]),u(S,{loading:x(r).processing,class:"full-width q-mt-lg",type:"submit",label:"Submit Data",color:"primary"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{Qe as default};
