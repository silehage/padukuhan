import{c as $,r as F,as as J,at as L,o as z,y as O,h as H,C as M,au as G,D as Q,ab as W,av as X,aw as Y,ax as Z,ay as ee,$ as te,i as D,e as S,f as C,j as s,w as c,g as t,L as q,R as B,q as y,S as I,az as N,ae,af as ne,I as se,F as j,V as oe,t as h,O as le,P as ue,aA as re}from"./app-CL658PO0.js";import{Q as ie}from"./QInput-CE_9Wjoc.js";import{Q as R,a as T}from"./QCard-B_urt7IV.js";import{Q as K,a as de}from"./QSelect-BGo0c00N.js";import{s as ce}from"./index-BWnLrXaf.js";import"./QMenu-ENEaV8kO.js";const fe=$({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:w,emit:o}){const b=O(),i=F(null);let m=0;const f=[];function P(e){const u=typeof e=="boolean"?e:l.noErrorFocus!==!0,v=++m,a=(n,r)=>{o(`validation${n===!0?"Success":"Error"}`,r)},V=n=>{const r=n.validate();return typeof r.then=="function"?r.then(p=>({valid:p,comp:n}),p=>({valid:!1,comp:n,err:p})):Promise.resolve({valid:r,comp:n})};return(l.greedy===!0?Promise.all(f.map(V)).then(n=>n.filter(r=>r.valid!==!0)):f.reduce((n,r)=>n.then(()=>V(r).then(p=>{if(p.valid===!1)return Promise.reject(p)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return v===m&&a(!0),!0;if(v===m){const{comp:r,err:p}=n[0];if(p!==void 0&&console.error(p),a(!1,r),u===!0){const A=n.find(({comp:E})=>typeof E.focus=="function"&&G(E.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function g(){m++,f.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function k(e){e!==void 0&&Q(e);const u=m+1;P().then(v=>{u===m&&v===!0&&(l.onSubmit!==void 0?o("submit",e):e?.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function x(e){e!==void 0&&Q(e),o("reset"),W(()=>{g(),l.autofocus===!0&&l.noResetFocus!==!0&&_()})}function _(){X(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),u=>u.tabIndex!==-1))?.focus({preventScroll:!0})})}Y(Z,{bindComponent(e){f.push(e)},unbindComponent(e){const u=f.indexOf(e);u!==-1&&f.splice(u,1)}});let d=!1;return J(()=>{d=!0}),L(()=>{d===!0&&l.autofocus===!0&&_()}),z(()=>{l.autofocus===!0&&_()}),Object.assign(b.proxy,{validate:P,resetValidation:g,submit:k,reset:x,focus:_,getValidationComponents:()=>f}),()=>H("form",{class:"q-form",ref:i,onSubmit:k,onReset:x},M(w.default))}}),pe={class:"flex justify-end q-gutter-sm"},me={class:"table-responsive"},ve={class:"table bordered"},be={class:"q-gutter-xs no-wrap"},ge={key:0},Pe={__name:"Index",props:["data","options","penduduk","queryParams"],setup(l){const w=l,o=ee({penduduk_id:"",pengurus_id:""}),b=F(!1),i=F(!1),m=d=>{i.value=!0,b.value=!0,o.penduduk_id=d.id,o.pengurus_id=d.pengurus_id??""},f=()=>{i.value=!1,b.value=!0},P=()=>{o.submit(re(),{onFinish:()=>{b.value=!1,o.penduduk_id="",o.pengurus_id=""}})},g=te({search:w.queryParams?.search||""}),k=()=>{I.visit(N({query:g}))},x=F([]),_=async(d,e)=>{if(!d||d==""){e(()=>{x.value=[]});return}const v=await(await fetch(ce(d).url)).json();e(()=>{x.value=v.map(a=>({label:a.nama_lengkap,value:a.id}))})};return(d,e)=>{const u=D("AppHeader"),v=D("AppPagination");return C(),S(j,null,[s(u,{title:"Susunan Pengurus"},{default:c(()=>[t("div",pe,[s(q,{color:"primary",onClick:f},{default:c(()=>e[5]||(e[5]=[B("Tambah Data",-1)])),_:1,__:[5]})])]),_:1}),s(T,{class:"section"},{default:c(()=>[s(R,null,{default:c(()=>[s(ie,{dense:"",outlined:"",placeholder:"Nama",class:"q-mb-md",modelValue:g.search,"onUpdate:modelValue":e[0]||(e[0]=a=>g.search=a),label:"Search",onKeydown:ae(ne(k,["prevent"]),["enter"]),clearable:"",onClear:e[1]||(e[1]=a=>y(I).visit(y(N)()))},{append:c(()=>[s(q,{size:"11px",disable:!g.search,color:"dark",icon:"search",flat:"",dense:"",onClick:k},null,8,["disable"])]),_:1},8,["modelValue","onKeydown"]),t("div",null,[t("div",me,[t("table",ve,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",{class:"text-left uppercase"},"#"),t("th",{class:"text-left uppercase"},"Nama"),t("th",{class:"text-left uppercase"},"Jabatan"),t("th",{class:"text-left uppercase"},"Jenis Kelamin"),t("th",{class:"text-left uppercase"},"Tempat Lahir"),t("th",{class:"text-left uppercase"},"Tanggal Lahir"),t("th",{class:"text-left uppercase"},"Status"),t("th",{class:"text-left uppercase"},"Aksi")])],-1)),t("tbody",null,[(C(!0),S(j,null,oe(l.data.data,(a,V)=>(C(),S("tr",{key:V},[t("td",null,h(1+V),1),t("td",null,h(a.nama_lengkap),1),t("td",null,h(a.jabatan),1),t("td",null,h(a.Jenis_kelamin),1),t("td",null,h(a.tempat_lahir),1),t("td",null,h(a.tanggal_lahir),1),t("td",null,h(a.status_perkawinan),1),t("td",be,[s(q,{class:"btn-action","no-caps":"",color:"blue",onClick:U=>m(a)},{default:c(()=>e[6]||(e[6]=[B("Edit",-1)])),_:2,__:[6]},1032,["onClick"])])]))),128)),l.data.total?se("",!0):(C(),S("tr",ge,e[7]||(e[7]=[t("td",{colspan:"20",class:"text-center"},"Tidak ada data",-1)])))])])]),s(v,le(ue(l.data)),null,16)])]),_:1})]),_:1}),s(de,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=a=>b.value=a)},{default:c(()=>[s(T,{class:"section card-lg"},{default:c(()=>[s(R,null,{default:c(()=>[e[9]||(e[9]=t("div",{class:"card-title"},"Update Pengurus",-1)),s(fe,{onSubmit:P},{default:c(()=>[s(K,{debounce:"700","use-input":"",disable:i.value,"emit-value":"","map-options":"",modelValue:y(o).penduduk_id,"onUpdate:modelValue":e[2]||(e[2]=a=>y(o).penduduk_id=a),label:"Nama Pengurus",options:x.value,onFilter:_},null,8,["disable","modelValue","options"]),s(K,{"emit-value":"","map-options":"",modelValue:y(o).pengurus_id,"onUpdate:modelValue":e[3]||(e[3]=a=>y(o).pengurus_id=a),label:"Jabatan",options:[{label:"Pilih",value:""},...l.options]},null,8,["modelValue","options"]),s(q,{loading:y(o).processing,class:"full-width q-mt-lg",type:"submit",label:"Submit Data",color:"primary"},null,8,["loading"])]),_:1})]),_:1,__:[9]})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{Pe as default};
