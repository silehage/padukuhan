import{c as J,r as E,at as L,au as H,o as M,ag as O,h as Y,ad as G,av as W,aw as B,ax as X,ay as Z,az as ee,aA as te,ao as ae,Y as ne,k as N,e as S,f as x,l,w as f,i as t,z as U,D as q,H as C,M as $,v as b,aB as oe,N as j,aC as I,a9 as se,aa as le,F as K,R as ue,t as k,K as re,L as ie,$ as de,U as ce,aD as fe,aE as pe}from"./app-DUr2e_ho.js";import{Q as me}from"./QInput-Bi4k1RDl.js";import{Q as R,a as T}from"./QCard-RDMg7hlf.js";import{Q as z,a as ve}from"./QSelect-DsOxfT8I.js";import{C as be}from"./ClosePopup-gdHTicwe.js";import"./use-key-composition-8jroF8kB.js";import"./private.use-form-Xm1ZRPt_.js";import"./QMenu-CSJpfavl.js";const ge=J({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(u,{slots:A,emit:r}){const g=O(),d=E(null);let m=0;const c=[];function F(a){const s=typeof a=="boolean"?a:u.noErrorFocus!==!0,e=++m,V=(o,i)=>{r(`validation${o===!0?"Success":"Error"}`,i)},h=o=>{const i=o.validate();return typeof i.then=="function"?i.then(p=>({valid:p,comp:o}),p=>({valid:!1,comp:o,err:p})):Promise.resolve({valid:i,comp:o})};return(u.greedy===!0?Promise.all(c.map(h)).then(o=>o.filter(i=>i.valid!==!0)):c.reduce((o,i)=>o.then(()=>h(i).then(p=>{if(p.valid===!1)return Promise.reject(p)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return e===m&&V(!0),!0;if(e===m){const{comp:i,err:p}=o[0];if(p!==void 0&&console.error(p),V(!1,i),s===!0){const D=o.find(({comp:Q})=>typeof Q.focus=="function"&&W(Q.$)===!1);D!==void 0&&D.comp.focus()}}return!1})}function _(){m++,c.forEach(a=>{typeof a.resetValidation=="function"&&a.resetValidation()})}function y(a){a!==void 0&&B(a);const s=m+1;F().then(e=>{s===m&&e===!0&&(u.onSubmit!==void 0?r("submit",a):a?.target!==void 0&&typeof a.target.submit=="function"&&a.target.submit())})}function P(a){a!==void 0&&B(a),r("reset"),X(()=>{_(),u.autofocus===!0&&u.noResetFocus!==!0&&v()})}function v(){Z(()=>{if(d.value===null)return;(d.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||d.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||d.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(d.value.querySelectorAll("[tabindex]"),s=>s.tabIndex!==-1))?.focus({preventScroll:!0})})}ee(te,{bindComponent(a){c.push(a)},unbindComponent(a){const s=c.indexOf(a);s!==-1&&c.splice(s,1)}});let w=!1;return L(()=>{w=!0}),H(()=>{w===!0&&u.autofocus===!0&&v()}),M(()=>{u.autofocus===!0&&v()}),Object.assign(g.proxy,{validate:F,resetValidation:_,submit:y,reset:P,focus:v,getValidationComponents:()=>c}),()=>Y("form",{class:"q-form",ref:d,onSubmit:y,onReset:P},G(A.default))}}),ye={class:"flex justify-end q-gutter-sm"},xe={class:"table-responsive"},ke={class:"table bordered"},he={key:0,class:"text-left uppercase"},Ce={class:"q-gutter-xs no-wrap"},Pe={key:0},Ve={class:"card-title flex justify-between items-center"},Se="Pengurus",Be={__name:"Index",props:["data","options","penduduk","queryParams"],setup(u){const A=u,r=ae({penduduk_id:"",pengurus_id:""}),g=E(!1),d=E(!1),m=s=>{d.value=!0,g.value=!0,r.penduduk_id=s.id,r.pengurus_id=s.pengurus_id??""},c=()=>{r.reset("penduduk_id","pengurus_id")},F=()=>{c(),d.value=!1,g.value=!0},_=()=>{r.submit(fe(),{onFinish:()=>{g.value=!1,c()}})},y=ne({search:A.queryParams?.search||""}),P=()=>{j.visit(I({query:y}))},v=E([]),w=async(s,e)=>{if(!s||s==""){e(()=>{v.value=[]});return}const h=await(await fetch(pe(s).url)).json();e(()=>{v.value=h.map(n=>({label:n.nama_lengkap,value:n.id}))})},a=s=>ce(`${s} ${Se}`);return(s,e)=>{const V=N("AppHeader"),h=N("AppPagination");return x(),S(K,null,[l(V,{title:"Susunan Pengurus"},{default:f(()=>[t("div",ye,[a("Create")?(x(),U(C,{key:0,color:"primary",onClick:F},{default:f(()=>e[5]||(e[5]=[$("Tambah Data",-1)])),_:1,__:[5]})):q("",!0),l(C,{label:"Export",color:"teal",href:b(oe)().url,target:"_blank"},null,8,["href"])])]),_:1}),l(T,{class:"section"},{default:f(()=>[l(R,null,{default:f(()=>[l(me,{dense:"",outlined:"",placeholder:"Nama",class:"q-mb-md",modelValue:y.search,"onUpdate:modelValue":e[0]||(e[0]=n=>y.search=n),label:"Search",onKeydown:se(le(P,["prevent"]),["enter"]),clearable:"",onClear:e[1]||(e[1]=n=>b(j).visit(b(I)()))},{append:f(()=>[l(C,{size:"11px",disable:!y.search,color:"dark",icon:"search",flat:"",dense:"",onClick:P},null,8,["disable"])]),_:1},8,["modelValue","onKeydown"]),t("div",null,[t("div",xe,[t("table",ke,[t("thead",null,[t("tr",null,[e[6]||(e[6]=t("th",{class:"text-left uppercase"},"#",-1)),e[7]||(e[7]=t("th",{class:"text-left uppercase"},"Nama",-1)),e[8]||(e[8]=t("th",{class:"text-left uppercase"},"Jabatan",-1)),e[9]||(e[9]=t("th",{class:"text-left uppercase"},"Jenis Kelamin",-1)),e[10]||(e[10]=t("th",{class:"text-left uppercase"},"Tempat Lahir",-1)),e[11]||(e[11]=t("th",{class:"text-left uppercase"},"Tanggal Lahir",-1)),e[12]||(e[12]=t("th",{class:"text-left uppercase"},"Status",-1)),a("Update")?(x(),S("th",he,"Aksi")):q("",!0)])]),t("tbody",null,[(x(!0),S(K,null,ue(u.data.data,(n,o)=>(x(),S("tr",{key:o},[t("td",null,k(u.data.from+o),1),t("td",null,k(n.nama_lengkap),1),t("td",null,k(n.jabatan),1),t("td",null,k(n.Jenis_kelamin),1),t("td",null,k(n.tempat_lahir),1),t("td",null,k(n.tanggal_lahir),1),t("td",null,k(n.status_perkawinan),1),t("td",Ce,[a("Update")?(x(),U(C,{key:0,color:"blue",class:"btn-action","no-caps":"",onClick:i=>m(n)},{default:f(()=>e[13]||(e[13]=[$("Edit",-1)])),_:2,__:[13]},1032,["onClick"])):q("",!0)])]))),128)),u.data.total?q("",!0):(x(),S("tr",Pe,e[14]||(e[14]=[t("td",{colspan:"20",class:"text-center"},"Tidak ada data",-1)])))])])]),l(h,re(ie(u.data)),null,16)])]),_:1})]),_:1}),l(ve,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=n=>g.value=n)},{default:f(()=>[l(T,{class:"section card-lg"},{default:f(()=>[l(R,null,{default:f(()=>[t("div",Ve,[e[15]||(e[15]=t("div",null,"Update Pengurus",-1)),de(l(C,{icon:"close",flat:"",round:"",dense:""},null,512),[[be]])]),l(ge,{onSubmit:_},{default:f(()=>[l(z,{debounce:"700","use-input":"",disable:d.value,"emit-value":"","map-options":"",modelValue:b(r).penduduk_id,"onUpdate:modelValue":e[2]||(e[2]=n=>b(r).penduduk_id=n),label:"Nama Pengurus",options:v.value,onFilter:w},null,8,["disable","modelValue","options"]),l(z,{"emit-value":"","map-options":"",modelValue:b(r).pengurus_id,"onUpdate:modelValue":e[3]||(e[3]=n=>b(r).pengurus_id=n),label:"Jabatan",options:[{label:"Pilih",value:""},...u.options]},null,8,["modelValue","options"]),l(C,{loading:b(r).processing,class:"full-width q-mt-lg",type:"submit",label:"Submit Data",color:"primary"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{Be as default};
