import{c as U,r as w,as as $,at as J,o as O,y as z,h as H,C as M,au as G,D as Q,ab as W,av as X,aw as Y,ax as Z,ay as ee,$ as te,i as D,e as P,f as F,j as o,w as c,g as t,L as q,R as B,s as _,S as I,az as N,ae,af as ne,I as oe,F as L,V as se,t as y,O as le,P as ue,aA as re}from"./app-DdILZ9tt.js";import{Q as ie}from"./QInput-DChJjhcS.js";import{Q as R,a as T}from"./QCard-BCaby6hE.js";import{Q as j,a as de}from"./QSelect-Dh9AAx_h.js";import"./QMenu-D_ThLViA.js";const ce=U({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(s,{slots:x,emit:l}){const b=z(),i=w(null);let m=0;const f=[];function S(e){const u=typeof e=="boolean"?e:s.noErrorFocus!==!0,v=++m,a=(n,r)=>{l(`validation${n===!0?"Success":"Error"}`,r)},V=n=>{const r=n.validate();return typeof r.then=="function"?r.then(p=>({valid:p,comp:n}),p=>({valid:!1,comp:n,err:p})):Promise.resolve({valid:r,comp:n})};return(s.greedy===!0?Promise.all(f.map(V)).then(n=>n.filter(r=>r.valid!==!0)):f.reduce((n,r)=>n.then(()=>V(r).then(p=>{if(p.valid===!1)return Promise.reject(p)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return v===m&&a(!0),!0;if(v===m){const{comp:r,err:p}=n[0];if(p!==void 0&&console.error(p),a(!1,r),u===!0){const A=n.find(({comp:E})=>typeof E.focus=="function"&&G(E.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function g(){m++,f.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function C(e){e!==void 0&&Q(e);const u=m+1;S().then(v=>{u===m&&v===!0&&(s.onSubmit!==void 0?l("submit",e):e?.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function h(e){e!==void 0&&Q(e),l("reset"),W(()=>{g(),s.autofocus===!0&&s.noResetFocus!==!0&&k()})}function k(){X(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),u=>u.tabIndex!==-1))?.focus({preventScroll:!0})})}Y(Z,{bindComponent(e){f.push(e)},unbindComponent(e){const u=f.indexOf(e);u!==-1&&f.splice(u,1)}});let d=!1;return $(()=>{d=!0}),J(()=>{d===!0&&s.autofocus===!0&&k()}),O(()=>{s.autofocus===!0&&k()}),Object.assign(b.proxy,{validate:S,resetValidation:g,submit:C,reset:h,focus:k,getValidationComponents:()=>f}),()=>H("form",{class:"q-form",ref:i,onSubmit:C,onReset:h},M(x.default))}}),fe={class:"flex justify-end q-gutter-sm"},pe={class:"table-responsive"},me={class:"table bordered"},ve={class:"q-gutter-xs no-wrap"},be={key:0},_e={__name:"Index",props:["data","options","penduduk","queryParams"],setup(s){const x=s,l=ee({penduduk_id:"",pengurus_id:""}),b=w(!1),i=w(!1),m=d=>{i.value=!0,b.value=!0,l.penduduk_id=d.id,l.pengurus_id=d.pengurus_id??""},f=()=>{i.value=!1,b.value=!0},S=()=>{l.submit(re(),{onFinish:()=>{b.value=!1,l.penduduk_id="",l.pengurus_id=""}})},g=te({search:x.queryParams?.search||""}),C=()=>{I.visit(N({query:g}))},h=w(x.penduduk),k=(d,e)=>{if(!d||d==""){e(()=>{h.value=x.penduduk});return}e(()=>{const u=d.toLowerCase();h.value=x.penduduk.filter(v=>v.label.toLowerCase().indexOf(u)>-1)})};return(d,e)=>{const u=D("AppHeader"),v=D("AppPagination");return F(),P(L,null,[o(u,{title:"Susunan Pengurus"},{default:c(()=>[t("div",fe,[o(q,{color:"primary",onClick:f},{default:c(()=>e[5]||(e[5]=[B("Tambah Data",-1)])),_:1,__:[5]})])]),_:1}),o(T,{class:"section"},{default:c(()=>[o(R,null,{default:c(()=>[o(ie,{dense:"",outlined:"",placeholder:"Nama",class:"q-mb-md",modelValue:g.search,"onUpdate:modelValue":e[0]||(e[0]=a=>g.search=a),label:"Search",onKeydown:ae(ne(C,["prevent"]),["enter"]),clearable:"",onClear:e[1]||(e[1]=a=>_(I).visit(_(N)()))},{append:c(()=>[o(q,{size:"11px",disable:!g.search,color:"dark",icon:"search",flat:"",dense:"",onClick:C},null,8,["disable"])]),_:1},8,["modelValue","onKeydown"]),t("div",null,[t("div",pe,[t("table",me,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",{class:"text-left uppercase"},"#"),t("th",{class:"text-left uppercase"},"Nama"),t("th",{class:"text-left uppercase"},"Jabatan"),t("th",{class:"text-left uppercase"},"Jenis Kelamin"),t("th",{class:"text-left uppercase"},"Tempat Lahir"),t("th",{class:"text-left uppercase"},"Tanggal Lahir"),t("th",{class:"text-left uppercase"},"Status"),t("th",{class:"text-left uppercase"},"Aksi")])],-1)),t("tbody",null,[(F(!0),P(L,null,se(s.data.data,(a,V)=>(F(),P("tr",{key:V},[t("td",null,y(1+V),1),t("td",null,y(a.nama_lengkap),1),t("td",null,y(a.jabatan),1),t("td",null,y(a.Jenis_kelamin),1),t("td",null,y(a.tempat_lahir),1),t("td",null,y(a.tanggal_lahir),1),t("td",null,y(a.status_perkawinan),1),t("td",ve,[o(q,{class:"btn-action","no-caps":"",color:"blue",onClick:K=>m(a)},{default:c(()=>e[6]||(e[6]=[B("Edit",-1)])),_:2,__:[6]},1032,["onClick"])])]))),128)),s.data.total?oe("",!0):(F(),P("tr",be,e[7]||(e[7]=[t("td",{colspan:"20",class:"text-center"},"Tidak ada data",-1)])))])])]),o(v,le(ue(s.data)),null,16)])]),_:1})]),_:1}),o(de,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=a=>b.value=a)},{default:c(()=>[o(T,{class:"section card-lg"},{default:c(()=>[o(R,null,{default:c(()=>[e[9]||(e[9]=t("div",{class:"card-title"},"Update Pengurus",-1)),o(ce,{onSubmit:S},{default:c(()=>[o(j,{"use-input":"",disable:i.value,"emit-value":"","map-options":"",modelValue:_(l).penduduk_id,"onUpdate:modelValue":e[2]||(e[2]=a=>_(l).penduduk_id=a),label:"Nama Pengurus",options:h.value,onFilter:k},null,8,["disable","modelValue","options"]),o(j,{"emit-value":"","map-options":"",modelValue:_(l).pengurus_id,"onUpdate:modelValue":e[3]||(e[3]=a=>_(l).pengurus_id=a),label:"Jabatan",options:[{label:"Pilih",value:""},...s.options]},null,8,["modelValue","options"]),o(q,{class:"full-width q-mt-lg",type:"submit",label:"Submit Data",color:"primary"})]),_:1})]),_:1,__:[9]})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{_e as default};
