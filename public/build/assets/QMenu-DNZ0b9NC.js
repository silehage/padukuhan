import{a_ as $,aY as ce,c as re,aD as fe,a$ as de,b0 as ve,b1 as A,ai as ge,x as he,aE as me,b2 as be,y as ye,r as R,b as c,z as ke,aG as xe,aF as Pe,aH as Ce,b3 as Te,b4 as Ee,aJ as Oe,aI as Se,b5 as H,aa as L,b6 as we,b7 as Q,b8 as qe,b9 as Be,ba as De,bb as Fe,h as W,aN as Me,C as Ke,aM as Ae,av as Re,aO as He,D as Le}from"./app-M7p6uJUc.js";const s=[];let r;function Qe(e){r=e.keyCode===27}function We(){r===!0&&(r=!1)}function _e(e){r===!0&&(r=!1,ce(e,27)===!0&&s[s.length-1](e))}function I(e){window[e]("keydown",Qe),window[e]("blur",We),window[e]("keyup",_e),r=!1}function $e(e){$.is.desktop===!0&&(s.push(e),s.length===1&&I("addEventListener"))}function _(e){const o=s.indexOf(e);o!==-1&&(s.splice(o,1),s.length===0&&I("removeEventListener"))}const i=[];function j(e){i[i.length-1](e)}function Ie(e){$.is.desktop===!0&&(i.push(e),i.length===1&&document.body.addEventListener("focusin",j))}function je(e){const o=i.indexOf(e);o!==-1&&(i.splice(o,1),i.length===0&&document.body.removeEventListener("focusin",j))}const Ge=re({name:"QMenu",inheritAttrs:!1,props:{...be,...me,...he,...ge,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:A},self:{type:String,validator:A},offset:{type:Array,validator:ve},scrollTarget:de,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...fe,"click","escapeKey"],setup(e,{slots:o,emit:g,attrs:m}){let u=null,h,f,b;const T=ye(),{proxy:y}=T,{$q:n}=y,a=R(null),l=R(!1),z=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),G=ke(e,n),{registerTick:J,removeTick:N}=xe(),{registerTimeout:E}=Pe(),{transitionProps:U,transitionStyle:Y}=Ce(e),{localScrollTarget:O,changeScrollEvent:V,unconfigureScrollTarget:X}=Te(e,M),{anchorEl:d,canShow:Z}=Ee({showing:l}),{hide:S}=Oe({showing:l,canShow:Z,handleShow:ne,handleHide:ae,hideOnRouteChange:z,processOnMount:!0}),{showPortal:w,hidePortal:q,renderPortal:p}=Se(T,a,ie,"menu"),k={anchorEl:d,innerRef:a,onClickOutside(t){if(e.persistent!==!0&&l.value===!0)return S(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Le(t),!0}},B=c(()=>H(e.anchor||(e.cover===!0?"center middle":"bottom start"),n.lang.rtl)),ee=c(()=>e.cover===!0?B.value:H(e.self||"top start",n.lang.rtl)),te=c(()=>(e.square===!0?" q-menu--square":"")+(G.value===!0?" q-menu--dark q-dark":"")),oe=c(()=>e.autoClose===!0?{onClick:se}:{}),D=c(()=>l.value===!0&&e.persistent!==!0);L(D,t=>{t===!0?($e(P),we(k)):(_(P),Q(k))});function x(){Re(()=>{let t=a.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function ne(t){if(u=e.noRefocus===!1?document.activeElement:null,Ie(K),w(),M(),h=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const C=qe(t);if(C.left!==void 0){const{top:ue,left:le}=d.value.getBoundingClientRect();h={left:C.left-le,top:C.top-ue}}}f===void 0&&(f=L(()=>n.screen.width+"|"+n.screen.height+"|"+e.self+"|"+e.anchor+"|"+n.lang.rtl,v)),e.noFocus!==!0&&document.activeElement.blur(),J(()=>{v(),e.noFocus!==!0&&x()}),E(()=>{n.platform.is.ios===!0&&(b=e.autoClose,a.value.click()),v(),w(!0),g("show",t)},e.transitionDuration)}function ae(t){N(),q(),F(!0),u!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?u.closest('[tabindex]:not([tabindex^="-"])'):void 0)||u).focus(),u=null),E(()=>{q(!0),g("hide",t)},e.transitionDuration)}function F(t){h=void 0,f!==void 0&&(f(),f=void 0),(t===!0||l.value===!0)&&(je(K),X(),Q(k),_(P)),t!==!0&&(u=null)}function M(){(d.value!==null||e.scrollTarget!==void 0)&&(O.value=Be(d.value,e.scrollTarget),V(O.value,v))}function se(t){b!==!0?(De(y,t),g("click",t)):b=!1}function K(t){D.value===!0&&e.noFocus!==!0&&He(a.value,t.target)!==!0&&x()}function P(t){e.noEscDismiss!==!0&&(g("escapeKey"),S(t))}function v(){Fe({targetEl:a.value,offset:e.offset,anchorEl:d.value,anchorOrigin:B.value,selfOrigin:ee.value,absoluteOffset:h,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ie(){return W(Me,U.value,()=>l.value===!0?W("div",{role:"menu",...m,ref:a,tabindex:-1,class:["q-menu q-position-engine scroll"+te.value,m.class],style:[m.style,Y.value],...oe.value},Ke(o.default)):null)}return Ae(F),Object.assign(y,{focus:x,updatePosition:v}),p}});export{Ge as Q,Ie as a,$e as b,_ as c,je as r};
