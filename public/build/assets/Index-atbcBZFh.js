import{c as L,r as w,an as O,ao as z,o as H,ad as M,h as W,aa as G,ap as X,aq as D,ar as Y,as as Z,at as ee,au as te,av as ae,W as ne,i as I,e as C,f as g,j as u,w as d,g as a,x as N,B as F,E as _,K as U,q as y,L as j,aw as K,a6 as se,a7 as oe,F as T,O as le,t as x,I as ue,J as re,S as ie,ax as de}from"./app-Dfb0CutN.js";import{Q as ce}from"./QInput-D4hLO-VP.js";import{Q as $,a as J}from"./QCard-CcfoajUC.js";import{Q as R,a as fe}from"./QSelect-ttQtPMuK.js";import{s as pe}from"./index-DBJUgkke.js";import"./private.use-form-ClbWrWT8.js";import"./QMenu-D-pd_Pa1.js";const me=L({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(o,{slots:E,emit:l}){const m=M(),i=w(null);let p=0;const c=[];function q(t){const e=typeof t=="boolean"?t:o.noErrorFocus!==!0,b=++p,S=(s,r)=>{l(`validation${s===!0?"Success":"Error"}`,r)},n=s=>{const r=s.validate();return typeof r.then=="function"?r.then(f=>({valid:f,comp:s}),f=>({valid:!1,comp:s,err:f})):Promise.resolve({valid:r,comp:s})};return(o.greedy===!0?Promise.all(c.map(n)).then(s=>s.filter(r=>r.valid!==!0)):c.reduce((s,r)=>s.then(()=>n(r).then(f=>{if(f.valid===!1)return Promise.reject(f)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return b===p&&S(!0),!0;if(b===p){const{comp:r,err:f}=s[0];if(f!==void 0&&console.error(f),S(!1,r),e===!0){const A=s.find(({comp:B})=>typeof B.focus=="function"&&X(B.$)===!1);A!==void 0&&A.comp.focus()}}return!1})}function v(){p++,c.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function V(t){t!==void 0&&D(t);const e=p+1;q().then(b=>{e===p&&b===!0&&(o.onSubmit!==void 0?l("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function k(t){t!==void 0&&D(t),l("reset"),Y(()=>{v(),o.autofocus===!0&&o.noResetFocus!==!0&&h()})}function h(){Z(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),e=>e.tabIndex!==-1))?.focus({preventScroll:!0})})}ee(te,{bindComponent(t){c.push(t)},unbindComponent(t){const e=c.indexOf(t);e!==-1&&c.splice(e,1)}});let P=!1;return O(()=>{P=!0}),z(()=>{P===!0&&o.autofocus===!0&&h()}),H(()=>{o.autofocus===!0&&h()}),Object.assign(m.proxy,{validate:q,resetValidation:v,submit:V,reset:k,focus:h,getValidationComponents:()=>c}),()=>W("form",{class:"q-form",ref:i,onSubmit:V,onReset:k},G(E.default))}}),ve={class:"flex justify-end q-gutter-sm"},be={class:"table-responsive"},ge={class:"table bordered"},ye={key:0,class:"text-left uppercase"},xe={class:"q-gutter-xs no-wrap"},ke={key:0},he="Pengurus",we={__name:"Index",props:["data","options","penduduk","queryParams"],setup(o){const E=o,l=ae({penduduk_id:"",pengurus_id:""}),m=w(!1),i=w(!1),p=t=>{i.value=!0,m.value=!0,l.penduduk_id=t.id,l.pengurus_id=t.pengurus_id??""},c=()=>{i.value=!1,m.value=!0},q=()=>{l.submit(de(),{onFinish:()=>{m.value=!1,l.penduduk_id="",l.pengurus_id=""}})},v=ne({search:E.queryParams?.search||""}),V=()=>{j.visit(K({query:v}))},k=w([]),h=async(t,e)=>{if(!t||t==""){e(()=>{k.value=[]});return}const S=await(await fetch(pe(t).url)).json();e(()=>{k.value=S.map(n=>({label:n.nama_lengkap,value:n.id}))})},P=t=>ie(`${t} ${he}`);return(t,e)=>{const b=I("AppHeader"),S=I("AppPagination");return g(),C(T,null,[u(b,{title:"Susunan Pengurus"},{default:d(()=>[a("div",ve,[P("Create")?(g(),N(_,{key:0,color:"primary",onClick:c},{default:d(()=>e[5]||(e[5]=[U("Tambah Data",-1)])),_:1,__:[5]})):F("",!0)])]),_:1}),u(J,{class:"section"},{default:d(()=>[u($,null,{default:d(()=>[u(ce,{dense:"",outlined:"",placeholder:"Nama",class:"q-mb-md",modelValue:v.search,"onUpdate:modelValue":e[0]||(e[0]=n=>v.search=n),label:"Search",onKeydown:se(oe(V,["prevent"]),["enter"]),clearable:"",onClear:e[1]||(e[1]=n=>y(j).visit(y(K)()))},{append:d(()=>[u(_,{size:"11px",disable:!v.search,color:"dark",icon:"search",flat:"",dense:"",onClick:V},null,8,["disable"])]),_:1},8,["modelValue","onKeydown"]),a("div",null,[a("div",be,[a("table",ge,[a("thead",null,[a("tr",null,[e[6]||(e[6]=a("th",{class:"text-left uppercase"},"#",-1)),e[7]||(e[7]=a("th",{class:"text-left uppercase"},"Nama",-1)),e[8]||(e[8]=a("th",{class:"text-left uppercase"},"Jabatan",-1)),e[9]||(e[9]=a("th",{class:"text-left uppercase"},"Jenis Kelamin",-1)),e[10]||(e[10]=a("th",{class:"text-left uppercase"},"Tempat Lahir",-1)),e[11]||(e[11]=a("th",{class:"text-left uppercase"},"Tanggal Lahir",-1)),e[12]||(e[12]=a("th",{class:"text-left uppercase"},"Status",-1)),P("Update")?(g(),C("th",ye,"Aksi")):F("",!0)])]),a("tbody",null,[(g(!0),C(T,null,le(o.data.data,(n,Q)=>(g(),C("tr",{key:Q},[a("td",null,x(o.data.from+Q),1),a("td",null,x(n.nama_lengkap),1),a("td",null,x(n.jabatan),1),a("td",null,x(n.Jenis_kelamin),1),a("td",null,x(n.tempat_lahir),1),a("td",null,x(n.tanggal_lahir),1),a("td",null,x(n.status_perkawinan),1),a("td",xe,[P("Update")?(g(),N(_,{key:0,class:"btn-action","no-caps":"",color:"blue",onClick:s=>p(n)},{default:d(()=>e[13]||(e[13]=[U("Edit",-1)])),_:2,__:[13]},1032,["onClick"])):F("",!0)])]))),128)),o.data.total?F("",!0):(g(),C("tr",ke,e[14]||(e[14]=[a("td",{colspan:"20",class:"text-center"},"Tidak ada data",-1)])))])])]),u(S,ue(re(o.data)),null,16)])]),_:1})]),_:1}),u(fe,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=n=>m.value=n)},{default:d(()=>[u(J,{class:"section card-lg"},{default:d(()=>[u($,null,{default:d(()=>[e[15]||(e[15]=a("div",{class:"card-title"},"Update Pengurus",-1)),u(me,{onSubmit:q},{default:d(()=>[u(R,{debounce:"700","use-input":"",disable:i.value,"emit-value":"","map-options":"",modelValue:y(l).penduduk_id,"onUpdate:modelValue":e[2]||(e[2]=n=>y(l).penduduk_id=n),label:"Nama Pengurus",options:k.value,onFilter:h},null,8,["disable","modelValue","options"]),u(R,{"emit-value":"","map-options":"",modelValue:y(l).pengurus_id,"onUpdate:modelValue":e[3]||(e[3]=n=>y(l).pengurus_id=n),label:"Jabatan",options:[{label:"Pilih",value:""},...o.options]},null,8,["modelValue","options"]),u(_,{loading:y(l).processing,class:"full-width q-mt-lg",type:"submit",label:"Submit Data",color:"primary"},null,8,["loading"])]),_:1})]),_:1,__:[15]})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{we as default};
